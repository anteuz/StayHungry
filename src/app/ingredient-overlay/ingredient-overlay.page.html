<!-- Search bar for the modal - styled to look connected -->
<ion-item lines="none" class="modal-searchbar-item">
  <ion-searchbar #ingredientBar
                 showCancelButton="false"
                 animated
                 (ionChange)="onIngredientNameChanged()"
                 placeholder="Type item : amount"
                 debounce="700"
                 (keyup.enter)="onAddFromSearchbar()"
                 (ionFocus)="onIngredientBarFocus()"
                 (ionBlur)="onIngredientBarBlur()"
                 searchIcon="nutrition">
  </ion-searchbar>
</ion-item>

<ion-content class="dropdown-content" (click)="onDismiss($event)">

  <div *ngIf="itemSuggestions.length > 0" class="suggestion-section">
    <div class="section-header">
      <ion-text color="medium">
        <small>{{ getSuggestionLabel() }}</small>
      </ion-text>
    </div>
    <ion-grid>
      <ion-row>
        <ion-col size="auto" *ngFor="let item of itemSuggestions; let j = index">
          <ion-button size="small" color="{{getButtonColor(item.itemColor)}}" (click)="pickSuggestion(item)">
            {{ item.itemName }}
            <span *ngIf="item.usageCount > 0" class="usage-badge">{{ item.usageCount }}</span>
          </ion-button>
        </ion-col>
      </ion-row>
    </ion-grid>
  </div>

  <div *ngIf="showItemColorSelector" class="color-selector-section">
    <ion-grid>
      <ion-row align-items-start>
        <ion-col size="auto">
          <ion-button class="listButton" (click)="chooseColor('--ion-color-itemColor1')" color="itemColor1"><ion-icon *ngIf="itemColorName === '--ion-color-itemColor1'" name="checkmark"></ion-icon></ion-button>
        </ion-col>
        <ion-col size="auto">
          <ion-button class="listButton" (click)="chooseColor('--ion-color-itemColor2')" color="itemColor2"><ion-icon *ngIf="itemColorName === '--ion-color-itemColor2'" name="checkmark"></ion-icon></ion-button>
        </ion-col>
        <ion-col size="auto">
          <ion-button class="listButton" (click)="chooseColor('--ion-color-itemColor3')" color="itemColor3"><ion-icon *ngIf="itemColorName === '--ion-color-itemColor3'" name="checkmark"></ion-icon></ion-button>
        </ion-col>
        <ion-col size="auto">
          <ion-button class="listButton" (click)="chooseColor('--ion-color-itemColor4')" color="itemColor4"><ion-icon *ngIf="itemColorName === '--ion-color-itemColor4'" name="checkmark"></ion-icon></ion-button>
        </ion-col>
        <ion-col size="auto">
          <ion-button class="listButton" (click)="chooseColor('--ion-color-itemColor5')" color="itemColor5"><ion-icon *ngIf="itemColorName === '--ion-color-itemColor5'" name="checkmark"></ion-icon></ion-button>
        </ion-col>
        <ion-col size="auto">
          <ion-button class="listButton" (click)="chooseColor('--ion-color-itemColor6')" color="itemColor6"><ion-icon *ngIf="itemColorName === '--ion-color-itemColor6'" name="checkmark"></ion-icon></ion-button>
        </ion-col>
        <ion-col size="auto">
          <ion-button class="listButton" (click)="chooseColor('--ion-color-itemColor7')" color="itemColor7"><ion-icon *ngIf="itemColorName === '--ion-color-itemColor7'" name="checkmark"></ion-icon></ion-button>
        </ion-col>
        <ion-col size="auto">
          <ion-button class="listButton" (click)="chooseColor('--ion-color-itemColor8')" color="itemColor8"><ion-icon *ngIf="itemColorName === '--ion-color-itemColor8'" name="checkmark"></ion-icon></ion-button>
        </ion-col>
      </ion-row>
    </ion-grid>
  </div>
  
  <!-- Back button section -->
  <div class="back-button-section">
    <ion-button 
      fill="clear" 
      color="medium" 
      size="large"
      class="back-button"
      (click)="onBack()"
      (keyup.enter)="onBack()"
      (keyup.space)="onBack()"
      tabindex="0"
      aria-label="Go back without adding items">
      <ion-icon name="arrow-back" slot="start"></ion-icon>
      Back
    </ion-button>
  </div>
</ion-content>
